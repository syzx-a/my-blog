{{ define "main" }}

<div class="live-list">
  <header class="page-header">
    <h1>{{ .Title }}</h1>
    {{ with .Content }}
    <div class="page-content">
      {{ . }}
    </div>
    {{ end }}
  </header>

  <section class="live-section">
    <h2>即将开始的直播</h2>
    {{ $upcoming := where .Pages "Params.livetime" "ge" (now.Format "2006-01-02T15:04:05") }}
    {{ if $upcoming }}
    <div class="live-grid">
      {{ range $upcoming }}
      <article class="live-card upcoming">
        <div class="live-header">
          <h3 class="live-title">
            <a href="{{ .Permalink }}">{{ .Title }}</a>
          </h3>
          {{ with .Params.cover }}
          <div class="live-cover">
            <img src="{{ . }}" alt="{{ $.Title }}" loading="lazy">
          </div>
          {{ end }}
        </div>
        
        <div class="live-body">
          <div class="live-meta">
            <span class="live-time">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10"></circle>
                <polyline points="12 6 12 12 16 14"></polyline>
              </svg>
              {{ .Params.livetime | time.Format "2006年1月2日 15:04" }}
            </span>
            <span class="live-platform">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polygon points="23 7 16 12 23 17 23 7"></polygon>
                <rect x="1" y="5" width="15" height="14" rx="2" ry="2"></rect>
              </svg>
              {{ .Params.platform }}
            </span>
          </div>
          
          {{ if .Params.description }}
          <p class="live-description">{{ .Params.description }}</p>
          {{ end }}
          
          {{ if .Params.link }}
          <a href="{{ .Params.link }}" class="live-link button" target="_blank" rel="noopener">
            前往直播间 →
          </a>
          {{ end }}
        </div>
      </article>
      {{ end }}
    </div>
    {{ else }}
    <p class="no-content">暂无直播预告，敬请期待！</p>
    {{ end }}
  </section>

  <section class="live-section">
    <h2>往期直播</h2>
    {{ $past := where .Pages "Params.livetime" "lt" (now.Format "2006-01-02T15:04:05") }}
    {{ if $past }}
    <div class="live-grid">
      {{ range $past }}
      <article class="live-card past">
        <div class="live-header">
          <h3 class="live-title">
            <a href="{{ .Permalink }}">{{ .Title }}</a>
          </h3>
        </div>
        
        <div class="live-body">
          <div class="live-meta">
            <span class="live-time">
              {{ .Params.livetime | time.Format "2006年1月2日" }}
            </span>
            <span class="live-platform">{{ .Params.platform }}</span>
          </div>
          
          {{ if .Params.description }}
          <p class="live-description">{{ .Params.description }}</p>
          {{ end }}
        </div>
      </article>
      {{ end }}
    </div>
    {{ else }}
    <p class="no-content">暂无直播回放</p>
    {{ end }}
  </section>
</div>

{{ end }}
